<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NGINX Prometheus Exporter Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        .header {
            text-align: center;
            background-color: #f4f4f4;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .services {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .service-card {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .service-card h3 {
            color: #0066cc;
            margin-top: 0;
        }
        .service-card a {
            color: #0066cc;
            text-decoration: none;
        }
        .service-card a:hover {
            text-decoration: underline;
        }
        .load-test {
            background-color: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        .load-test button {
            background-color: #0066cc;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
        }
        .load-test button:hover {
            background-color: #0052a3;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            background-color: #f4f4f4;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîß NGINX Prometheus Exporter Demo</h1>
        <p>This is a demo environment showcasing NGINX monitoring with Prometheus and Grafana</p>
    </div>

    <div class="services">
        <div class="service-card">
            <h3>üìä Prometheus</h3>
            <p>Time-series database collecting metrics from NGINX</p>
            <a href="http://localhost:9090" target="_blank">Open Prometheus ‚Üí</a>
        </div>

        <div class="service-card">
            <h3>üìà Grafana</h3>
            <p>Visualization dashboard for NGINX metrics</p>
            <p><strong>Login:</strong> admin / admin123</p>
            <a href="http://localhost:3000" target="_blank">Open Grafana ‚Üí</a>
        </div>

        <div class="service-card">
            <h3>üîç NGINX Exporter</h3>
            <p>Prometheus exporter for NGINX metrics</p>
            <a href="http://localhost:9113/metrics" target="_blank">View Metrics ‚Üí</a>
        </div>

        <div class="service-card">
            <h3>‚öôÔ∏è NGINX Status</h3>
            <p>Raw NGINX stub_status information</p>
            <a href="http://localhost:8081/stub_status" target="_blank">View Status ‚Üí</a>
        </div>
    </div>

    <div class="load-test">
        <h3>üöÄ Load Testing</h3>
        <p>Generate some traffic to see metrics in action:</p>
        <button onclick="sendRequests()">Send 100 Requests</button>
        <button onclick="sendSlowRequests()">Send Slow Requests</button>
        <button onclick="sendAPIRequests()">Send API Requests</button>
        <div id="results"></div>
    </div>

    <div class="footer">
        <p>üê≥ This demo is powered by Docker Compose</p>
        <p>Check the <a href="https://github.com/nginx/nginx-prometheus-exporter" target="_blank">NGINX Prometheus Exporter repository</a> for more information</p>
    </div>

    <script>
        function sendRequests() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Sending 100 requests...</p>';
            
            let completed = 0;
            for (let i = 0; i < 100; i++) {
                fetch('/?load-test=' + i)
                    .then(() => {
                        completed++;
                        if (completed === 100) {
                            results.innerHTML = '<p>‚úÖ Completed 100 requests! Check Prometheus/Grafana for updated metrics.</p>';
                        }
                    })
                    .catch(() => {
                        completed++;
                        if (completed === 100) {
                            results.innerHTML = '<p>‚ö†Ô∏è Completed requests (some may have failed). Check metrics for details.</p>';
                        }
                    });
            }
        }

        function sendSlowRequests() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Sending slow requests...</p>';
            
            let completed = 0;
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    fetch('/?slow-test=' + i)
                        .then(() => {
                            completed++;
                            if (completed === 20) {
                                results.innerHTML = '<p>‚úÖ Completed 20 slow requests! Check response time metrics.</p>';
                            }
                        })
                        .catch(() => {
                            completed++;
                            if (completed === 20) {
                                results.innerHTML = '<p>‚ö†Ô∏è Completed slow requests (some may have failed).</p>';
                            }
                        });
                }, i * 100);
            }
        }

        function sendAPIRequests() {
            const results = document.getElementById('results');
            results.innerHTML = '<p>Sending API requests...</p>';
            
            let completed = 0;
            for (let i = 0; i < 50; i++) {
                fetch('/api/test' + i)
                    .then(() => {
                        completed++;
                        if (completed === 50) {
                            results.innerHTML = '<p>‚úÖ Completed 50 API requests! Check metrics for API endpoint stats.</p>';
                        }
                    })
                    .catch(() => {
                        completed++;
                        if (completed === 50) {
                            results.innerHTML = '<p>‚ö†Ô∏è Completed API requests (some may have failed).</p>';
                        }
                    });
            }
        }
    </script>
</body>
</html>
